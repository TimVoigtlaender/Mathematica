(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16846,        410]
NotebookOptionsPosition[     16448,        396]
NotebookOutlinePosition[     16796,        411]
CellTagsIndexPosition[     16753,        408]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<VariationalMethods`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", "x_", "]"}], "=", 
   RowBox[{"a", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"omega", "*", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPendulum", "[", 
    RowBox[{"theta_Real", ",", "t_Real", ",", "subs_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "w", ",", "p1", ",", "p2", ",", "le", ",", "ps", ",", "ra", ",", 
       "lines", ",", "dots", ",", "ceil", ",", "text", ",", "text2", ",", 
       "all", ",", "pendulum"}], "}"}], ",", 
     RowBox[{
      RowBox[{"w", "=", "1"}], ";", 
      RowBox[{"(*", "width", "*)"}], 
      RowBox[{"(*", "Punkte", "*)"}], 
      RowBox[{"p1", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", 
           RowBox[{"h", "[", "t", "]"}]}]}], "}"}], "/.", "subs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l"}], "*", 
           RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"h", "[", "t", "]"}]}], "-", 
           RowBox[{"l", "*", 
            RowBox[{"Cos", "[", "theta", "]"}]}]}]}], "}"}], "/.", "subs"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "Groessenskala", "*)"}], 
      RowBox[{"le", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "a"}], ")"}], "/.", "subs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Ausma\[SZ]e", " ", "der", " ", "Decke"}], "*)"}], 
      RowBox[{"ps", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "l"}], ",", 
            RowBox[{"-", "a"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "a"}], "}"}]}], "}"}], "/.", "subs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"dargestellter", " ", "Bereich"}], "*)"}], 
      RowBox[{"ra", "=", 
       RowBox[{"le", "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.05"}], ",", "1.05"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2.15"}], ",", "2.15"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Decke", ",", 
        RowBox[{"Linien", " ", "und", " ", "Punkte"}]}], "*)"}], 
      RowBox[{"ceil", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Lighter", "[", "Brown", "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Dashed", "]"}], ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{"Sequence", "@@", "ps"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "p1"}], "}"}], "]"}], ",", 
         RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dots", "=", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"PointSize", "[", "0.04", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "p1"}], "}"}], "]"}], ",", 
         "Red", ",", 
         RowBox[{"PointSize", "[", "0.1", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", "p2", "}"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Text", "*)"}], 
      RowBox[{"text", "=", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Background", "\[Rule]", "White"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"m", ",", 
           RowBox[{"p2", "+", 
            RowBox[{"{", 
             RowBox[{"w", ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"l", ",", 
           RowBox[{"p1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p2", "-", "p1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.05", "*", "le"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Fasse", " ", "alles", " ", 
        RowBox[{"zusammen", ":"}]}], "*)"}], 
      RowBox[{"all", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"lines", ",", "dots", ",", "text"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Timer", "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "=!=", "False"}], ",", 
        RowBox[{
         RowBox[{"text2", "=", 
          RowBox[{"{", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\< t = \>\"", "<>", 
              RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\< s \>\""}], ",", 
             RowBox[{
              RowBox[{"ps", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ps", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "2"}], "+", 
                 "0.1"}]}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"all", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"all", ",", "text2"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"all", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ceil", ",", "all"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pendulum", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", "all", "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "ra"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pendulum", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pendel", "[", 
   RowBox[{"data_List", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m", ",", "tmp", ",", "g", ",", "\[Theta]", ",", "t", ",", "x", ",", 
      "theta", ",", "v", ",", "u"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", "9.81"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "[", "x_", "]"}], "=", 
      RowBox[{
       RowBox[{"m", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"l", "^", "2"}], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]", "'"}], "[", "x", "]"}], "^", "2"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"h", "'"}], "[", "x", "]"}], "*", "l", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "x", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "x", "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "[", "x_", "]"}], "=", 
      RowBox[{
       RowBox[{"-", "m"}], "*", "g", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h", "[", "x", "]"}], "+", 
         RowBox[{"l", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "x", "]"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"EulerEquations", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "x", "]"}], "-", 
              RowBox[{"u", "[", "x", "]"}]}], ",", 
             RowBox[{"\[Theta]", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
           "data"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"phi0", "+", "Pi"}]}], "/.", "data"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", 
            "phip0"}], "/.", "data"}]}], "}"}], ",", 
        RowBox[{"\[Theta]", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"time", "/.", "data"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Animate", "[", 
        RowBox[{
         RowBox[{"plotPendulum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "[", "x", "]"}], "/.", 
             RowBox[{"tmp", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
            RowBox[{"x", "\[Rule]", "t"}]}], ",", "t", ",", "data"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"time", "/.", "data"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "[", "x", "]"}], "/.", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
          RowBox[{"x", "\[Rule]", "t"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"time", "/.", "data"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7190994177686653`*^9, 3.719099562083747*^9}, {
   3.7190996044486303`*^9, 3.7190996440547442`*^9}, {3.7190996762205353`*^9, 
   3.7190998635471797`*^9}, {3.719100084818307*^9, 3.7191001719005775`*^9}, {
   3.719100219475031*^9, 3.719100221953407*^9}, 3.719100409936752*^9, {
   3.719100657140053*^9, 3.7191007004364724`*^9}, 3.7191007886217785`*^9, {
   3.7191009674437356`*^9, 3.719101008721195*^9}, {3.719101055215624*^9, 
   3.7191010935352507`*^9}, {3.719101151951104*^9, 3.7191012988575687`*^9}, {
   3.719101349301776*^9, 3.7191013719163857`*^9}, {3.719101402830969*^9, 
   3.7191015422762794`*^9}, {3.719101584451253*^9, 3.719101610008685*^9}, 
   3.7191016611205482`*^9, {3.7191017644132977`*^9, 3.7191018151538057`*^9}, {
   3.719101880532281*^9, 3.719102298926298*^9}, {3.719102412739085*^9, 
   3.7191025633251905`*^9}, {3.7191299858623576`*^9, 3.719129986308813*^9}, {
   3.7191307735560527`*^9, 3.7191307964169226`*^9}, {3.7191308313363066`*^9, 
   3.7191309126990614`*^9}, {3.7191309618140435`*^9, 
   3.7191309660330777`*^9}, {3.719131015035925*^9, 3.719131048785161*^9}, {
   3.719131140817149*^9, 3.71913118852075*^9}, {3.7191324401333323`*^9, 
   3.719132647661731*^9}, {3.7191327858107753`*^9, 3.719132824961203*^9}, {
   3.7191328676850758`*^9, 3.7191329080486364`*^9}, {3.7191330274898214`*^9, 
   3.719133029116406*^9}, {3.7191330668254566`*^9, 3.7191330704649363`*^9}, {
   3.719133105807724*^9, 3.7191331317074566`*^9}, {3.719133208234615*^9, 
   3.7191332101865005`*^9}, {3.719133247907564*^9, 3.719133264954852*^9}, {
   3.7191333236479626`*^9, 3.719133340531101*^9}, {3.7191334404166126`*^9, 
   3.719133458843229*^9}, {3.7191334907056904`*^9, 3.719133491661604*^9}, {
   3.719133620907155*^9, 3.7191336209942226`*^9}, {3.7191336891704483`*^9, 
   3.719133725697377*^9}, {3.7191343583474627`*^9, 3.7191343587448177`*^9}, {
   3.7191344337755675`*^9, 3.7191344342930727`*^9}, {3.719134474454458*^9, 
   3.719134474959941*^9}, {3.7192321018660173`*^9, 3.7192321400546017`*^9}, {
   3.719232212295692*^9, 3.7192322127266035`*^9}, {3.719233773260453*^9, 
   3.719233778651608*^9}, {3.7192339180258536`*^9, 3.71923398893667*^9}, {
   3.719234532529107*^9, 3.7192345329695272`*^9}, 3.719234596891638*^9, {
   3.7192346426864185`*^9, 3.719234718571966*^9}, {3.719237910829734*^9, 
   3.7192379444177628`*^9}, {3.7192381954633956`*^9, 
   3.7192381961206417`*^9}, {3.719242334822945*^9, 3.7192423350706034`*^9}, 
   3.7192433477505875`*^9, {3.7192434204459143`*^9, 3.719243433475945*^9}, {
   3.719243468636166*^9, 3.719243515513543*^9}, {3.7192436858197317`*^9, 
   3.7192437341923285`*^9}, {3.719243830135599*^9, 3.719243869322852*^9}, {
   3.719243933938545*^9, 3.7192439924683576`*^9}, {3.719245976498864*^9, 
   3.7192459985933495`*^9}, {3.719246032040595*^9, 3.719246096524246*^9}, {
   3.719246148198405*^9, 3.719246225880846*^9}, {3.7192464646283283`*^9, 
   3.7192465974894867`*^9}, {3.719246638245283*^9, 3.7192466415935555`*^9}, 
   3.7192468144501715`*^9, {3.7192469021053085`*^9, 3.71924691150121*^9}, {
   3.719246943822839*^9, 3.719246943919442*^9}, {3.7192469834654474`*^9, 
   3.719247033796564*^9}, {3.719247069559756*^9, 3.7192471845205736`*^9}, {
   3.7192472197351284`*^9, 3.7192472838484144`*^9}, {3.7192473625726967`*^9, 
   3.719247423120551*^9}, {3.719247539674265*^9, 3.7192475562322903`*^9}, {
   3.7192476177781286`*^9, 3.719247730809168*^9}, {3.7192477828415565`*^9, 
   3.71924790066669*^9}, {3.71924793559507*^9, 3.7192481577686005`*^9}, {
   3.719248194986181*^9, 3.719248231554453*^9}, {3.7192482792520523`*^9, 
   3.719248367320881*^9}, {3.719248522126319*^9, 3.7192485233594966`*^9}, {
   3.719248587491948*^9, 3.7192486949391594`*^9}, {3.719248783382535*^9, 
   3.7192488103242846`*^9}, {3.71924886310355*^9, 3.719248881007695*^9}, {
   3.7192489307652345`*^9, 3.719248953771231*^9}, {3.7192491476259685`*^9, 
   3.719249158782605*^9}, {3.719249196018888*^9, 3.719249331927292*^9}, {
   3.7192493888879027`*^9, 3.7192493927275667`*^9}, 3.719251678463888*^9, 
   3.719252271621446*^9, {3.7192523042466354`*^9, 3.7192523284527764`*^9}, {
   3.7192524091692114`*^9, 3.719252413683524*^9}, 3.7192524711935053`*^9, 
   3.7192526647009525`*^9, {3.719252711212405*^9, 3.7192527319261913`*^9}, {
   3.719252772818265*^9, 3.719252784041998*^9}, {3.719252841241679*^9, 
   3.719252858084012*^9}},ExpressionUUID->"032134e0-0c2e-497b-9189-\
3f9b83831582"],

Cell[BoxData[
 RowBox[{"Pendel", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l", "\[Rule]", "10"}], ",", 
     RowBox[{"phi0", "\[Rule]", "3"}], ",", 
     RowBox[{"phip0", "\[Rule]", ".01"}], ",", 
     RowBox[{"a", "\[Rule]", ".5"}], ",", 
     RowBox[{"omega", "\[Rule]", 
      RowBox[{"2", "Pi", "*", "1"}]}], ",", 
     RowBox[{"time", "\[Rule]", "10"}]}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{
  3.719248987915872*^9, 3.7192491320860825`*^9, {3.7192492315691967`*^9, 
   3.7192492363798256`*^9}, {3.719249348666278*^9, 3.719249377991495*^9}, {
   3.7192494669765787`*^9, 3.719249491778236*^9}, {3.7192522799544234`*^9, 
   3.719252288622729*^9}, {3.7192523347391896`*^9, 3.7192523403715897`*^9}, {
   3.7192524218523335`*^9, 3.7192524789389105`*^9}, {3.7192527568420134`*^9, 
   3.7192527604274206`*^9}, {3.7192527966320353`*^9, 
   3.7192530277124968`*^9}},ExpressionUUID->"cba938e2-2cd4-4742-8e1e-\
e7b7072849e3"]
},
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 14926, 352, 939, "Input",ExpressionUUID->"032134e0-0c2e-497b-9189-3f9b83831582"],
Cell[15487, 374, 957, 20, 45, "Input",ExpressionUUID->"cba938e2-2cd4-4742-8e1e-e7b7072849e3"]
}
]
*)

